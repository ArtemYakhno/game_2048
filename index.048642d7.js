const e=new class{#e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];size=4;#t=2048;constructor(e){e&&(this.#e=structuredClone(e)),this.board=structuredClone(this.#e),this.score=0}moveLeft(){this.#s("left")}moveRight(){this.#s("right")}moveUp(){this.#s("up")}moveDown(){this.#s("down")}getScore(){return this.score}getState(){return this.board}getStatus(){return this.#r()?"idle":this.#i()?"win":this.#o()?"lose":"playing"}start(){this.#n()}restart(){this.board=structuredClone(this.#e),this.score=0,this.#n()}#r(){return JSON.stringify(this.board)===JSON.stringify(this.#e)}#i(){return this.board.flat().includes(this.#t)}#o(){return!this.#a()}#a(){for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)if(0===this.board[e][t]||t<this.size-1&&this.board[e][t]===this.board[e][t+1]||e<this.size-1&&this.board[e][t]===this.board[e+1][t])return!0;return!1}#n(){this.#h(),this.#h()}#s(e){let t=structuredClone(this.board),s=!1;"up"===e?t=this.#d(t):"down"===e?t=this.#d(t).map(e=>e.reverse()):"right"===e&&(t=t.map(e=>e.reverse()));for(let e=0;e<this.size;e++){let r=t[e].filter(e=>0!==e),i=[];for(let e=0;e<r.length;e++)r[e]===r[e+1]?(i.push(2*r[e]),this.score+=2*r[e],e++):i.push(r[e]);for(;i.length<this.size;)i.push(0);JSON.stringify(i)!==JSON.stringify(t[e])&&(s=!0,t[e]=i)}"up"===e?t=this.#d(t):"down"===e?t=this.#d(t.map(e=>e.reverse())):"right"===e&&(t=t.map(e=>e.reverse())),this.board=t,0!==this.#l().length&&s&&this.#h()}#d(e){return e[0].map((t,s)=>e.map(e=>e[s]))}#h(){let e=this.#c(0,this.size,this.#l()),t=this.#c(0,this.size,this.#u(e)),s=this.#m();this.board[e][t]=s}#c(e,t,s=[]){let r;do r=Math.floor(Math.random()*(t-e))+e;while(!s.includes(r))return r}#l(){return this.board.map((e,t)=>{if(e.some(e=>0===e))return t}).filter(e=>void 0!==e)}#u(e){return this.board[e].map((e,t)=>{if(0===e)return t}).filter(e=>void 0!==e)}#m(){return Math.floor(101*Math.random())+0<=10?4:2}},t=document.querySelector(".button.start"),s=document.querySelector(".message-win"),r=document.querySelector(".message-lose"),i=document.querySelector(".message-start"),o=document.querySelector(".game-score"),n=document.querySelector(".game-field tbody");let a=0,h=0,d=0,l=0;function c(t){let s=!0;if("lose"!==e.getStatus()&&"idle"!==e.getStatus()){switch(t){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;default:s=!1}s&&u()}}function u(){let t=e.getState();for(let s=0;s<e.size;s++)for(let r=0;r<e.size;r++){let e=n.rows[s].cells[r],i=t[s][r];e.textContent=0===i?"":i,e.className=0===i?"field-cell":`field-cell field-cell--${i}`}o.textContent=e.getScore(),function(){let t=e.getStatus();i.classList.toggle("hidden","idle"!==t),s.classList.toggle("hidden","win"!==t),r.classList.toggle("hidden","lose"!==t)}()}document.addEventListener("touchstart",e=>{a=e.touches[0].clientX,h=e.touches[0].clientY}),document.addEventListener("touchend",e=>{d=e.changedTouches[0].clientX,l=e.changedTouches[0].clientY,function(){let e=d-a,t=l-h;if(!(30>Math.abs(e)&&30>Math.abs(t)))c(Math.abs(e)>Math.abs(t)?e>0?"ArrowRight":"ArrowLeft":t>0?"ArrowDown":"ArrowUp")}()}),document.addEventListener("keydown",e=>{c(e.key)}),t.addEventListener("click",()=>{"idle"===e.getStatus()?(i.classList.add("hidden"),t.classList.remove("start"),t.classList.add("restart"),t.textContent="Restart",e.start()):e.restart(),u()});
//# sourceMappingURL=index.048642d7.js.map
