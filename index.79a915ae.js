!function(){function t(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function e(e,i){var n=t(e,i,"get");return n.get?n.get.call(e):n.value}function i(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function n(t,e,n){i(t,e),e.set(t,n)}function r(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function s(t,e){i(t,e),e.add(t)}var a=/*#__PURE__*/new WeakMap,o=/*#__PURE__*/new WeakMap,c=/*#__PURE__*/new WeakSet,l=/*#__PURE__*/new WeakSet,u=/*#__PURE__*/new WeakSet,h=/*#__PURE__*/new WeakSet,f=/*#__PURE__*/new WeakSet,d=/*#__PURE__*/new WeakSet,v=/*#__PURE__*/new WeakSet,w=/*#__PURE__*/new WeakSet,g=/*#__PURE__*/new WeakSet,m=/*#__PURE__*/new WeakSet,b=/*#__PURE__*/new WeakSet,p=/*#__PURE__*/new WeakSet;function y(){return JSON.stringify(this.board)===JSON.stringify(e(this,a))}function k(){return this.board.flat().includes(e(this,o))}function S(){return!r(this,h,L).call(this)}function L(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++)if(0===this.board[t][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1]||t<this.size-1&&this.board[t][e]===this.board[t+1][e])return!0;return!1}function W(){r(this,w,C).call(this),r(this,w,C).call(this)}function z(t){var e=this,i=structuredClone(this.board),n=!1;"up"===t?i=r(this,v,M).call(this,i):"down"===t?i=r(this,v,M).call(this,i).map(function(t){return t.reverse()}):"right"===t&&(i=i.map(function(t){return t.reverse()}));for(var s=0;s<this.size;s++)!function(t){for(var r=i[t].filter(function(t){return 0!==t}),s=[],a=0;a<r.length;a++)r[a]===r[a+1]?(s.push(2*r[a]),e.score+=2*r[a],a++):s.push(r[a]);for(;s.length<e.size;)s.push(0);JSON.stringify(s)!==JSON.stringify(i[t])&&(n=!0,i[t]=s)}(s);"up"===t?i=r(this,v,M).call(this,i):"down"===t?i=r(this,v,M).call(this,i.map(function(t){return t.reverse()})):"right"===t&&(i=i.map(function(t){return t.reverse()})),this.board=i,0!==r(this,m,A).call(this).length&&n&&r(this,w,C).call(this)}function M(t){return t[0].map(function(e,i){return t.map(function(t){return t[i]})})}function C(){var t=r(this,g,E).call(this,0,this.size,r(this,m,A).call(this)),e=r(this,g,E).call(this,0,this.size,r(this,b,T).call(this,t)),i=r(this,p,q).call(this);this.board[t][e]=i}function E(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];do i=Math.floor(Math.random()*(e-t))+t;while(!n.includes(i))return i}function A(){return this.board.map(function(t,e){if(t.some(function(t){return 0===t}))return e}).filter(function(t){return void 0!==t})}function T(t){return this.board[t].map(function(t,e){if(0===t)return e}).filter(function(t){return void 0!==t})}function q(){return Math.floor(101*Math.random())+0<=10?4:2}var O=new/*#__PURE__*/(function(){var i;function L(i){var r,y;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,L),s(this,c),s(this,l),s(this,u),s(this,h),s(this,f),s(this,d),s(this,v),s(this,w),s(this,g),s(this,m),s(this,b),s(this,p),n(this,a,{writable:!0,value:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}),(r="size")in this?Object.defineProperty(this,r,{value:4,enumerable:!0,configurable:!0,writable:!0}):this[r]=4,n(this,o,{writable:!0,value:2048}),i&&(y=structuredClone(i),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,t(this,a,"set"),y)),this.board=structuredClone(e(this,a)),this.score=0}return i=[{key:"moveLeft",value:function(){r(this,d,z).call(this,"left")}},{key:"moveRight",value:function(){r(this,d,z).call(this,"right")}},{key:"moveUp",value:function(){r(this,d,z).call(this,"up")}},{key:"moveDown",value:function(){r(this,d,z).call(this,"down")}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return r(this,c,y).call(this)?"idle":r(this,l,k).call(this)?"win":r(this,u,S).call(this)?"lose":"playing"}},{key:"start",value:function(){r(this,f,W).call(this)}},{key:"restart",value:function(){this.board=structuredClone(e(this,a)),this.score=0,r(this,f,W).call(this)}}],function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(L.prototype,i),L}()),N=document.querySelector(".button.start"),R=document.querySelector(".message-win"),D=document.querySelector(".message-lose"),J=document.querySelector(".message-start"),U=document.querySelector(".game-score"),j=document.querySelector(".game-field tbody"),x=0,P=0,X=0,Y=0;function B(t){var e=!0;if("lose"!==O.getStatus()&&"idle"!==O.getStatus()){switch(t){case"ArrowUp":O.moveUp();break;case"ArrowDown":O.moveDown();break;case"ArrowLeft":O.moveLeft();break;case"ArrowRight":O.moveRight();break;default:e=!1}e&&F()}}function F(){for(var t,e=O.getState(),i=0;i<O.size;i++)for(var n=0;n<O.size;n++){var r=j.rows[i].cells[n],s=e[i][n];r.textContent=0===s?"":s,r.className=0===s?"field-cell":"field-cell field-cell--".concat(s)}U.textContent=O.getScore(),t=O.getStatus(),J.classList.toggle("hidden","idle"!==t),R.classList.toggle("hidden","win"!==t),D.classList.toggle("hidden","lose"!==t)}document.addEventListener("touchstart",function(t){x=t.touches[0].clientX,P=t.touches[0].clientY}),document.addEventListener("touchend",function(t){var e,i;X=t.changedTouches[0].clientX,Y=t.changedTouches[0].clientY,e=X-x,i=Y-P,30>Math.abs(e)&&30>Math.abs(i)||B(Math.abs(e)>Math.abs(i)?e>0?"ArrowRight":"ArrowLeft":i>0?"ArrowDown":"ArrowUp")}),document.addEventListener("keydown",function(t){B(t.key)}),N.addEventListener("click",function(){"idle"===O.getStatus()?(J.classList.add("hidden"),N.classList.remove("start"),N.classList.add("restart"),N.textContent="Restart",O.start()):O.restart(),F()})}();
//# sourceMappingURL=index.79a915ae.js.map
